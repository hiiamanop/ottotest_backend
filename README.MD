# ğŸš€ Voucher Redemption Service (Backend Test)

Backend API service for voucher redemption, built with Go (Golang), Clean Architecture, PostgreSQL, Docker, and full unit testing.  
Submission for Backend Developer Test.

---

## âœ¨ Features

- Clean/Hexagonal Architecture
- Voucher-Brand, Customer, Transaction entities
- Redemption transaction logic with point validation
- Input validation & error handling
- Database migration
- Unit tests with gomock
- Docker & docker-compose ready
- API documentation with Swagger (OpenAPI)
- Environment config via .env

---

## ğŸš€ Quick Start

**1. Clone Repository & Setup .env**

```bash
git clone https://github.com/your-username/ottotest_backend.git
cd ottotest_backend
cp .env.example .env  # Edit if needed (DB credentials, etc)
```

**2. Build & Run all services (App, DB, Migration)**

```bash
docker-compose up --build
```

App: http://localhost:8080  
Swagger: http://localhost:8080/swagger/index.html  
DB: localhost:5432 (ottotest_db)

**3. Run Database Migration (if not auto-run)**

```bash
docker-compose run migrate
```

**4. Run Unit Tests (in local dev)**

```bash
go test ./internal/...
```

## ğŸ§ª API Endpoints

- POST /brand - Create brand
- POST /voucher - Create voucher
- GET /voucher?id={voucher_id} - Get voucher by ID
- GET /voucher/brand?id={brand_id} - Get all vouchers by brand
- POST /transaction/redemption - Create redemption transaction (multi-voucher)
- GET /transaction/redemption?transactionId={id} - Get transaction detail
- POST /customer - Create customer
- GET /customer?id={id} - Get customer by ID

See Swagger UI for full documentation & schema.

## ğŸ—‚ï¸ Project Structure

```
voucher-redemption-service/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ main.go
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â”œâ”€â”€ entity/
â”‚   â”‚   â””â”€â”€ repository/
â”‚   â”œâ”€â”€ usecase/
â”‚   â”‚   â””â”€â”€ service/
â”‚   â”œâ”€â”€ infrastructure/
â”‚   â”‚   â”œâ”€â”€ persistence/
â”‚   â”‚   â””â”€â”€ http/
â”‚   â””â”€â”€ interface/
â”‚       â”œâ”€â”€ handler/
â”‚       â””â”€â”€ dto/
â”œâ”€â”€ pkg/
â”‚   â”œâ”€â”€ config/
â”‚   â””â”€â”€ util/
â”œâ”€â”€ migrations/
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ go.mod
â”œâ”€â”€ go.sum
â””â”€â”€ README.md
```

## âš™ï¸ Environment Variables

Set in .env (see .env.example):

- DATABASE_URL
- APP_PORT
- etc

## ğŸ§ª Testing

Unit Tests (with gomock):

```bash
go test ./internal/...
```

Run inside Docker:

```bash
docker-compose exec app go test ./internal/...
```

## ğŸ“ Notes

- Default PostgreSQL credentials can be changed in docker-compose.yml and .env.
- Migrations auto-run on docker-compose up (can be run manually if needed).
- See migrations/ for SQL schema.

## ğŸ‘¤ Author

Ahmad Naufal Muzakki

## ğŸ“„ License

MIT
EOF
